(this["webpackJsonpforwarder-demo"]=this["webpackJsonpforwarder-demo"]||[]).push([[0],{274:function(e,t,n){},307:function(e,t){},346:function(e,t){},348:function(e,t){},357:function(e,t){},359:function(e,t){},384:function(e,t){},385:function(e,t){},390:function(e,t){},392:function(e,t){},409:function(e,t){},571:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),s=n.n(r),i=n(83),o=n.n(i),p=(n(274),n(2)),u=n.n(p),c=n(13),l=n(34),d=n.p+"static/media/logo.ed1865ad.svg",y=n(577),b=n(578),m=n(579),f=n(9),x=n(582),h=function(e){var t=e.onClickFunction,n=e.buttonText,r=s.a.useState(!1),i=Object(l.a)(r,2),o=i[0],p=i[1];return Object(a.jsxs)(b.a,{as:"nav",align:"center",justify:"space-between",wrap:"wrap",padding:"1.5rem",bg:"teal.900",color:"white",children:[Object(a.jsx)(b.a,{align:"center",mr:5,children:Object(a.jsx)(m.a,{src:d,height:"50px"})}),Object(a.jsx)(f.a,{display:{base:"block",md:"none"},onClick:function(){return p(!o)},children:Object(a.jsxs)("svg",{fill:"white",width:"12px",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[Object(a.jsx)("title",{children:"Menu"}),Object(a.jsx)("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})}),Object(a.jsx)(f.a,{display:{sm:o?"block":"none",md:"flex"},width:{sm:"full",md:"auto"},alignItems:"center",flexGrow:1}),Object(a.jsx)(f.a,{display:{sm:o?"block":"none",md:"block"},mt:{base:4,md:0},children:Object(a.jsx)(x.a,{onClick:t,bg:"transparent",border:"1px",children:n})})]})},O=n(583),T=n(148),j=n.n(T),g=n(268),v=n(15),w=n(261);var k=function(e){var t=e.store,n=e.dispatch,r=Object(g.a)(),s=r.register,i=r.handleSubmit,o=function(){var e=Object(c.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t.tokenWallet){e.next=9;break}return e.t0=parseFloat,e.next=4,t.tokenWallet.token.balanceOf(t.address);case 4:e.t1=e.sent.toString(),e.t2=(0,e.t0)(e.t1),e.t3=Math.pow(10,18),a=(e.t2/e.t3).toFixed(2),n({type:"UPDATE_BALANCE",tokenBalance:a});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(w.a)(o,4e3);var p=function(){var e=Object(c.a)(u.a.mark((function e(a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("submitted"),e.t0=parseFloat,e.t1=v.ethers.utils,e.next=5,t.tokenWallet.estimateTransferCost(a.to,a.amount);case 5:e.t2=e.sent,e.t3=e.t1.formatEther.call(e.t1,e.t2),r=(0,e.t0)(e.t3).toFixed(2),console.log("fee : "+r),n({type:"PROPOSE_TX",amount:a.amount,fee:r,to:a.to});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"LOADING"}),e.prev=1,e.next=4,t.tokenWallet.permitFeeProxy();case 4:n({type:"FEE_PROXY_APPROVED"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:n({type:"NOT_LOADING"});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"LOADING"}),e.prev=1,e.next=4,t.tokenWallet.permitTransferHandler();case 4:n({type:"TRANSFER_HANDLER_APPROVED"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:n({type:"NOT_LOADING"});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return t.loggedIn?t.transferHandlerApproved&&t.feeProxyApproved?Object(a.jsxs)("div",{children:[Object(a.jsx)(j.a,{value:"ethereum:"+t.address,bgColor:"#FEEBC8",fgColor:"#1D4044"}),Object(a.jsxs)(y.a,{fontSize:"72px",fontWeight:"600",color:"teal.900",children:["\u25c8 ",t.tokenBalance," "]}),Object(a.jsxs)("form",{onSubmit:i(p),children:[Object(a.jsx)(y.a,{fontSize:"xl",color:"teal.900",fontWeight:"600",children:" Send To"}),Object(a.jsx)(O.a,{name:"to",ref:s({pattern:/^0x[a-fA-F0-9]{40}$/}),placeholder:"Enter Destination Address",size:"lg"}),Object(a.jsx)("br",{}),Object(a.jsx)(y.a,{fontSize:"xl",color:"teal.900",fontWeight:"600",children:" Amount To Send"}),Object(a.jsx)(O.a,{type:"number",name:"amount",ref:s({min:0}),placeholder:"e.g 420.69",size:"lg"}),Object(a.jsx)("br",{}),Object(a.jsx)(x.a,{type:"submit",w:"100%",leftIcon:"arrow-right",bg:"teal.700",color:"orange.200",children:"Send"})]})]}):Object(a.jsxs)("div",{children:[Object(a.jsx)(j.a,{value:"ethereum:"+t.address,bgColor:"#FEEBC8",fgColor:"#1D4044"}),Object(a.jsxs)(y.a,{fontSize:"96px",fontWeight:"600",color:"teal.900",children:["\u25c8 ",t.tokenBalance," "]}),Object(a.jsx)(y.a,{fontSize:"3xl",color:"red.900",fontWeight:"600",children:" Approval Needed to Proceed "}),Object(a.jsx)(x.a,{onClick:l,isDisabled:t.feeProxyApproved,leftIcon:"lock",bg:"red.700",color:"orange.200",children:"Approve Biconomy Fee Proxy"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(x.a,{onClick:d,isDisabled:t.transferHandlerApproved,leftIcon:"lock",bg:"red.700",color:"orange.200",children:"Approve Transfer Handler"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]}):Object(a.jsx)("div",{})},A=n(14);var M=function(e,t){switch(t.type){case"LOGIN":return{logOutModal:!1,loading:!1,loggedIn:!0,txModal:!1,tokenWallet:t.tokenWallet,address:t.address,tokenBalance:t.tokenBalance,transferHandlerApproved:t.transferHandlerApproved,transferHandlerApproval:null,feeProxyApproved:t.feeProxyApproved,feeProxyApproval:null,transferAmount:"",transferFee:"",transferDestination:"",txHash:""};case"LOGOUT":return{loggedIn:!1,loading:!1,txModal:!1,tokenWallet:void 0,tokenBalance:0,transferDestination:""};case"LOGOUT_MODAL":return Object(A.a)(Object(A.a)({},e),{},{logOutModal:!0});case"CANCEL_LOGOUT_MODAL":return Object(A.a)(Object(A.a)({},e),{},{logOutModal:!1});case"UPDATE_BALANCE":return Object(A.a)(Object(A.a)({},e),{},{tokenBalance:t.tokenBalance});case"UPDATE_TOKEN_GAS_PRICE":return Object(A.a)(Object(A.a)({},e),{},{tokenGasPrice:t.tokenGasPrice});case"LOADING":return Object(A.a)(Object(A.a)({},e),{},{loading:!0});case"NOT_LOADING":return Object(A.a)(Object(A.a)({},e),{},{loading:!1});case"SIGN_TRANSFER_HANDLER_APPROVAL":return Object(A.a)(Object(A.a)({},e),{},{transferHandlerApproval:t.transferHandlerApproval});case"TRANSFER_HANDLER_APPROVED":return Object(A.a)(Object(A.a)({},e),{},{transferHandlerApproved:!0});case"SIGN_FEE_PROXY_APPROVAL":return Object(A.a)(Object(A.a)({},e),{},{feeProxyApproval:t.feeProxyApproval});case"FEE_PROXY_APPROVED":return Object(A.a)(Object(A.a)({},e),{},{feeProxyApproved:!0});case"PROPOSE_TX":return Object(A.a)(Object(A.a)({},e),{},{transferAmount:t.amount,transferFee:t.fee,transferDestination:t.to,txModal:!0});case"CANCEL_TX_MODAL":return Object(A.a)(Object(A.a)({},e),{},{txModal:!1});case"TX_HASH":return Object(A.a)(Object(A.a)({},e),{},{txHash:t.txHash});default:return e}},P=n(262),C=n(263),E="0x4F96Fe3b7A6Cf9725f59d353F723c1bDb64CA6Aa",N="0x78122426ee7a6D35f15c4095b4Aa72A2A6418202",S="0x4AB0652B1049607F9E51E61144767d1C978950d0",D="xR3-_k6UZ.87776d1b-d23a-4a7c-8ab2-d651a8c92341",F=[{inputs:[{internalType:"uint256",name:"chainId_",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!0,internalType:"address",name:"guy",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!0,inputs:[{indexed:!0,internalType:"bytes4",name:"sig",type:"bytes4"},{indexed:!0,internalType:"address",name:"usr",type:"address"},{indexed:!0,internalType:"bytes32",name:"arg1",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"arg2",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"data",type:"bytes"}],name:"LogNote",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!0,internalType:"address",name:"dst",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Transfer",type:"event"},{constant:!0,inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"PERMIT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"usr",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"usr",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"burn",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"guy",type:"address"}],name:"deny",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"usr",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"mint",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"src",type:"address"},{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"move",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"holder",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"bool",name:"allowed",type:"bool"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"usr",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"pull",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"usr",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"push",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"guy",type:"address"}],name:"rely",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"src",type:"address"},{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"",type:"address"}],name:"wards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],_=new v.ethers.providers.InfuraProvider("kovan","d126f392798444609246423b06116c77"),I=new v.ethers.Contract("0x025d39AA202A552487ac9282dC343773cb60bbB5",[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"ethGasPrice",type:"uint256"}],name:"getTokenGasPrice",outputs:[{internalType:"uint256",name:"tokenGasPriceUnadjusted",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"getTokenOracleDecimals",outputs:[{internalType:"uint8",name:"_tokenOracleDecimals",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"getTokenPrice",outputs:[{internalType:"uint256",name:"tokenPriceUnadjusted",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"callAddress",type:"address"},{internalType:"uint8",name:"decimals",type:"uint8"},{internalType:"bytes",name:"callData",type:"bytes"},{internalType:"bool",name:"signed",type:"bool"}],name:"setTokenOracle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],_),R=new v.ethers.Contract(S,[{inputs:[{internalType:"address",name:"_forwarder",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"forwarder",type:"address"}],name:"isTrustedForwarder",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"trustedForwarder",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"versionRecipient",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}],_),G=new v.ethers.Contract(N,[{inputs:[{internalType:"uint256",name:"_transferHandlerGas",type:"uint256"},{internalType:"address",name:"_feeReceiver",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"address payable",name:"_forwarder",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"uint256",name:"batchId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"batchNonce",type:"uint256"},{indexed:!1,internalType:"uint256",name:"charge",type:"uint256"},{indexed:!1,internalType:"address",name:"token",type:"address"}],name:"FeeCharged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{components:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"txGas",type:"uint256"},{internalType:"uint256",name:"tokenGasPrice",type:"uint256"},{internalType:"uint256",name:"batchId",type:"uint256"},{internalType:"uint256",name:"batchNonce",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct ERC20ForwardRequestTypes.ERC20ForwardRequest",name:"req",type:"tuple"},{internalType:"bytes32",name:"domainSeparator",type:"bytes32"},{internalType:"bytes",name:"sig",type:"bytes"}],name:"executeEIP712",outputs:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"ret",type:"bytes"}],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"txGas",type:"uint256"},{internalType:"uint256",name:"tokenGasPrice",type:"uint256"},{internalType:"uint256",name:"batchId",type:"uint256"},{internalType:"uint256",name:"batchNonce",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct ERC20ForwardRequestTypes.ERC20ForwardRequest",name:"req",type:"tuple"},{internalType:"bytes",name:"sig",type:"bytes"}],name:"executePersonalSign",outputs:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"ret",type:"bytes"}],stateMutability:"payable",type:"function"},{inputs:[],name:"feeReceiver",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"uint256",name:"batchId",type:"uint256"}],name:"getNonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"oracleAggregator",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeReceiver",type:"address"}],name:"setFeeReceiver",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"oa",type:"address"}],name:"setOracleAggregator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_transferHandlerGas",type:"uint256"}],name:"setTransferHandlerGas",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],_),L={name:"Dai Stablecoin",version:"1",chainId:42,verifyingContract:"0x4F96Fe3b7A6Cf9725f59d353F723c1bDb64CA6Aa"},H={name:"TEST",version:"1",chainId:42,verifyingContract:"0xBFA21CD2F21a8E581E77942B2831B378d2378E69"},B=[{name:"from",type:"address"},{name:"to",type:"address"},{name:"token",type:"address"},{name:"txGas",type:"uint256"},{name:"tokenGasPrice",type:"uint256"},{name:"batchId",type:"uint256"},{name:"batchNonce",type:"uint256"},{name:"deadline",type:"uint256"},{name:"dataHash",type:"bytes32"}],W=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],z=[{name:"holder",type:"address"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"expiry",type:"uint256"},{name:"allowed",type:"bool"}],U=function(){var e=Object(c.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.etherscan.io/api?module=gastracker&action=gasoracle&apikey=P7JFS2YI6MNZFVY95FDMV45EGIX6F1BPAV");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,console.log("Response JSON "+JSON.stringify(n)),e.abrupt("return",v.ethers.utils.parseUnits(n.result.FastGasPrice,"gwei").toString());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){function e(t){Object(P.a)(this,e),this.token=new v.ethers.Contract(E,F,_),this.wallet=t}return Object(C.a)(e,[{key:"transferHandlerApproved",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.token,e.next=3,this.wallet.getSigner();case 3:return e.next=5,e.sent.getAddress();case 5:return e.t1=e.sent,e.t2=S,e.next=9,e.t0.allowance.call(e.t0,e.t1,e.t2);case 9:if(!(e.sent>0)){e.next=14;break}return e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"feeProxyApproved",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.token,e.next=3,this.wallet.getSigner();case 3:return e.next=5,e.sent.getAddress();case 5:return e.t1=e.sent,e.t2=N,e.next=9,e.t0.allowance.call(e.t0,e.t1,e.t2);case 9:if(!(e.sent>0)){e.next=14;break}return e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTokenGasPrice",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=v.ethers.BigNumber,e.next=3,U();case 3:return e.t1=e.sent,t=e.t0.from.call(e.t0,e.t1),e.next=7,I.getTokenPrice(E);case 7:return n=e.sent,e.next=10,I.getTokenOracleDecimals(E);case 10:return a=e.sent,console.log("token oracle decimals "+a.toString()),console.log("token gas price "+t.mul(v.ethers.BigNumber.from(10).pow(a)).div(n).toString()),e.abrupt("return",t.mul(v.ethers.BigNumber.from(10).pow(a)).div(n).toString());case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"permitFeeProxy",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.forwardPermit(N);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"permitTransferHandler",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.forwardPermit(S);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"forwardPermit",value:function(){var e=Object(c.a)(u.a.mark((function e(t){var n,a,r,s,i,o,p,c,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wallet.getSigner();case 2:return e.next=4,e.sent.getAddress();case 4:return n=e.sent,e.next=7,this.token.nonces(n);case 7:return a=e.sent,r={types:{EIP712Domain:W,Permit:z},domain:L,primaryType:"Permit",message:{holder:n,spender:t,nonce:a.toString(),expiry:"1000000000000000000000000000",allowed:!0}},e.next=11,this.wallet.send("eth_signTypedData_v4",[n,JSON.stringify(r)]);case 11:return s=e.sent,console.log("success",s),i=s.substring(2),o="0x"+i.substring(0,64),p="0x"+i.substring(64,128),c=parseInt(i.substring(128,130),16),console.log("v r s",c," ",o," ",p),l={to:E,apiId:"3d944962-5461-4489-ba92-4fbdf5860894",params:[n,t,a.toString(),"1000000000000000000000000000",!0,c,o,p],from:n},e.next=21,fetch("https://api.biconomy.io/api/v2/meta-tx/native",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":D},body:JSON.stringify(l)});case 21:d=e.sent,console.log(d);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"estimateTransferGas",value:function(){var e=Object(c.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v.ethers.BigNumber.from(75e3));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"estimateTransferCost",value:function(){var e=Object(c.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=v.ethers.BigNumber.from(12e4),e.t1=v.ethers.BigNumber,e.next=4,this.getTokenGasPrice();case 4:return e.t2=e.sent,e.t3=e.t1.from.call(e.t1,e.t2),e.abrupt("return",e.t0.mul.call(e.t0,e.t3).mul(v.ethers.BigNumber.from(15)).div(v.ethers.BigNumber.from(10)));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"forwardTransfer",value:function(){var e=Object(c.a)(u.a.mark((function e(t,n){var a,r,s,i,o,p,c,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wallet.getSigner();case 2:return e.next=4,e.sent.getAddress();case 4:return a=e.sent,e.t0=a,e.t1=S,e.t2=E,e.next=10,this.estimateTransferGas(n,t);case 10:return e.t3=e.sent.toNumber(),e.next=13,this.getTokenGasPrice();case 13:return e.t4=e.sent,e.next=16,G.getNonce(a,0);case 16:return e.t5=e.sent.toNumber(),e.t6=Math.floor(Date.now()/1e3+3600),e.next=20,R.populateTransaction.transfer(E,n,t);case 20:return e.t7=e.sent.data,r={from:e.t0,to:e.t1,token:e.t2,txGas:e.t3,tokenGasPrice:e.t4,batchId:0,batchNonce:e.t5,deadline:e.t6,data:e.t7},s=v.ethers.utils.keccak256(v.ethers.utils.defaultAbiCoder.encode(["bytes32","bytes32","bytes32","uint256","address"],[v.ethers.utils.id("EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)"),v.ethers.utils.id(H.name),v.ethers.utils.id(H.version),H.chainId,H.verifyingContract])),(i=Object.assign({},r)).dataHash=v.ethers.utils.keccak256(i.data),delete i.data,o={types:{EIP712Domain:W,ERC20ForwardRequest:B},domain:H,primaryType:"ERC20ForwardRequest",message:i},e.next=29,this.wallet.send("eth_signTypedData_v4",[r.from,JSON.stringify(o)]);case 29:return p=e.sent,c={to:N,apiId:"9ef1709e-385b-4590-9786-890fc086c0c4",params:[r,s,p],from:a},e.next=33,fetch("https://api.biconomy.io/api/v2/meta-tx/native",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":D},body:JSON.stringify(c)});case 33:return l=e.sent,e.next=36,l.json();case 36:return d=e.sent,e.abrupt("return",d.txHash);case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),X=n(264),J=n.n(X),q=n(265),Y={walletconnect:{package:n.n(q).a,options:{infuraId:"d126f392798444609246423b06116c77"}}},Z=new J.a({cacheProvider:!1,providerOptions:Y}),K=n(69),$=n(584);var Q=function(e){return 0==e.loggedIn?Object(a.jsxs)("div",{children:[Object(a.jsx)(y.a,{fontSize:"3xl",children:"This demo showcases our new ERC20Forwarder system"}),Object(a.jsxs)(y.a,{fontSize:"xl",children:[Object(a.jsx)("br",{}),"It allows you to make dApps which charge users for gas in ERC20 tokens, instead of Ether"]}),Object(a.jsx)(y.a,{fontSize:"3xl",children:"Please login (connect wallet) to proceed :)"})]}):Object(a.jsx)("div",{})},ee=n(581),te=n(580);var ne=function(){console.log(M);var e=Object(r.useReducer)(M,{loggedIn:!1,loading:!1,txModal:!1,tokenBalance:0,transferDestination:"",txHash:""}),t=Object(l.a)(e,2),n=t[0],s=t[1],i=function(){var e=Object(c.a)(u.a.mark((function e(){var t,a,r,i,o,p,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.loggedIn){e.next=5;break}console.log(n),s({type:"LOGOUT_MODAL"}),e.next=34;break;case 5:return e.prev=5,e.next=8,Z.connect();case 8:return t=e.sent,a=new v.ethers.providers.Web3Provider(t),r=a.getSigner(),e.next=13,r.getAddress();case 13:return i=e.sent,o=new V(a),e.t0=parseFloat,e.next=18,o.token.balanceOf(i);case 18:return e.t1=e.sent.toString(),e.t2=(0,e.t0)(e.t1),e.t3=Math.pow(10,18),p=(e.t2/e.t3).toFixed(2),e.next=24,o.transferHandlerApproved(i);case 24:return c=e.sent,e.next=27,o.feeProxyApproved(i);case 27:l=e.sent,s({type:"LOGIN",tokenWallet:o,address:i,tokenBalance:p,transferHandlerApproved:c,feeProxyApproved:l}),e.next=34;break;case 31:e.prev=31,e.t4=e.catch(5),console.log(e.t4);case 34:case"end":return e.stop()}}),e,null,[[5,31]])})));return function(){return e.apply(this,arguments)}}(),o=function(){s({type:"CANCEL_LOGOUT_MODAL"})},p=function(){s({type:"CANCEL_TX_MODAL"})},d=function(){var e=Object(c.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"CANCEL_TX_MODAL"}),s({type:"LOADING"}),e.prev=2,e.next=5,n.tokenWallet.forwardTransfer(v.ethers.utils.parseEther(n.transferAmount),n.transferDestination);case 5:return t=e.sent,e.t0=parseFloat,e.next=9,n.tokenWallet.token.balanceOf(n.address);case 9:e.t1=e.sent.toString(),e.t2=(0,e.t0)(e.t1),e.t3=Math.pow(10,18),a=(e.t2/e.t3).toFixed(2),console.log(t),s({type:"UPDATE_BALANCE",tokenBalance:a}),s({type:"TX_HASH",txHash:t}),e.next=21;break;case 18:e.prev=18,e.t4=e.catch(2),console.log(e.t4);case 21:s({type:"NOT_LOADING"});case 22:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(K.a,{children:[Object(a.jsx)($.a,{}),Object(a.jsxs)(ee.a,{isOpen:n.txModal,onClose:p,children:[Object(a.jsx)(ee.f,{}),Object(a.jsxs)(ee.c,{children:[Object(a.jsx)(ee.e,{children:"Transaction Details"}),Object(a.jsxs)(ee.b,{children:[Object(a.jsxs)(y.a,{fontWeight:"600",fontSize:"3xl",children:["You're sending \u25c8",n.transferAmount]}),Object(a.jsxs)(y.a,{fontSize:"2xl",children:["to ",n.transferDestination.substring(0,7),"......",n.transferDestination.substring(n.transferDestination.length-6)]}),Object(a.jsx)("br",{}),Object(a.jsxs)(y.a,{fontSize:"2xl",children:["(paying a \u25c8",n.transferFee," fee)"]})]}),Object(a.jsxs)(ee.d,{children:[Object(a.jsx)(x.a,{variantColor:"red",mr:3,onClick:p,children:"CANCEL"}),Object(a.jsx)(x.a,{variantColor:"blue",onClick:d,children:"CONFIRM"})]})]})]}),Object(a.jsxs)(ee.a,{isOpen:n.logOutModal,onClose:o,children:[Object(a.jsx)(ee.f,{}),Object(a.jsxs)(ee.c,{children:[Object(a.jsx)(ee.e,{children:"Log Out?"}),Object(a.jsxs)(ee.d,{children:[Object(a.jsx)(x.a,{variantColor:"red",mr:3,onClick:function(){s({type:"LOGOUT"})},children:"Yes"}),Object(a.jsx)(x.a,{variantColor:"blue",onClick:o,children:"No"})]}),Object(a.jsx)(ee.e,{children:"Previous Transaction"}),Object(a.jsx)(x.a,{variantColor:"blue",onClick:function(){window.open("https://kovan.etherscan.io/tx/"+n.txHash)},children:"View On Etherscan"})]})]}),Object(a.jsxs)(ee.a,{isOpen:n.loading,children:[Object(a.jsx)(ee.f,{}),Object(a.jsx)(ee.c,{children:Object(a.jsx)(ee.b,{children:Object(a.jsx)(te.a,{size:"240px",isIndeterminate:!0,color:"green"})})})]}),Object(a.jsx)(h,{buttonText:n.loggedIn?n.address:"Login",onClickFunction:i}),Object(a.jsx)(f.a,{pt:"50px",children:Object(a.jsxs)(f.a,{boxShadow:"lg",borderRadius:"20px",p:"40px",w:"500px",my:"auto",mx:"auto",color:"black",bg:"orange.100",children:[Object(a.jsx)(Q,{loggedIn:n.loggedIn}),Object(a.jsx)(k,{store:n,dispatch:s})]})})]})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,585)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))};o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(ne,{})}),document.getElementById("root")),ae()}},[[571,1,2]]]);
//# sourceMappingURL=main.e96094b8.chunk.js.map